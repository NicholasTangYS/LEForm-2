<div class="login-container">
  <h2 *ngIf="!isForgotPassword && !isResettingPassword">{{ isRegister ? 'Register' : 'Login' }}</h2>
  <h2 *ngIf="isForgotPassword">Forgot Password</h2>
  <h2 *ngIf="isResettingPassword">Reset Password</h2>

  <!-- Registration Form -->
  <form *ngIf="isRegister && !isForgotPassword && !isResettingPassword" (ngSubmit)="onSubmit()" [formGroup]="registerForm">
    <div>
      <label>Name</label>
      <input type="text" formControlName="name" />
      <div *ngIf="registerForm.get('name')?.invalid && registerForm.get('name')?.touched" class="error">
        <p>Name is required.</p>
      </div>
    </div>
    <div>
      <label>Contact Number</label>
      <input type="text" formControlName="contact" />
       <div *ngIf="registerForm.get('contact')?.invalid && registerForm.get('contact')?.touched" class="error">
        <p>Contact number is required.</p>
      </div>
    </div>
    <div>
      <label>Email</label>
      <input type="email" formControlName="email" />
       <div *ngIf="registerForm.get('email')?.invalid && registerForm.get('email')?.touched" class="error">
        <p *ngIf="registerForm.get('email')?.errors?.['required']">Email is required.</p>
        <p *ngIf="registerForm.get('email')?.errors?.['email']">Please enter a valid email.</p>
      </div>
    </div>
    <div>
      <label>Password</label>
      <input type="password" formControlName="password" />
       <div *ngIf="registerForm.get('password')?.invalid && registerForm.get('password')?.touched" class="error">
        <p *ngIf="registerForm.get('password')?.errors?.['required']">Password is required.</p>
        <p *ngIf="registerForm.get('password')?.errors?.['minlength']">Password must be at least 8 characters.</p>
      </div>
    </div>
    <div>
      <label>Confirm Password</label>
      <input type="password" formControlName="confirmPassword" />
      <!-- Specific error for the required validator -->
      <div *ngIf="registerForm.get('confirmPassword')?.hasError('required') && registerForm.get('confirmPassword')?.touched" class="error">
          <p>Confirming your password is required.</p>
      </div>
      <!-- Specific error for the mismatch validator on the form group -->
      <div *ngIf="registerForm.hasError('passwordsMismatch') && registerForm.get('confirmPassword')?.touched" class="error">
         <p>Passwords do not match.</p>
      </div>
    </div>
    <button type="submit" [disabled]="registerForm.invalid">Register</button>
    <p *ngIf="errorMessage" class="error">{{ errorMessage }}</p>
  </form>

  <!-- Login Form -->
  <form *ngIf="!isRegister && !isForgotPassword && !isResettingPassword" (ngSubmit)="onSubmit()" [formGroup]="loginForm">
    <div>
      <label>Email</label>
      <input type="email" formControlName="email" />
       <div *ngIf="loginForm.get('email')?.invalid && loginForm.get('email')?.touched" class="error">
        <p *ngIf="loginForm.get('email')?.errors?.['required']">Email is required.</p>
        <p *ngIf="loginForm.get('email')?.errors?.['email']">Please enter a valid email.</p>
      </div>
    </div>
    <div>
      <label>Password</label>
      <input type="password" formControlName="password" />
       <div *ngIf="loginForm.get('password')?.invalid && loginForm.get('password')?.touched" class="error">
        <p>Password is required.</p>
      </div>
    </div>
    <button type="submit" [disabled]="loginForm.invalid">Login</button>
    <p *ngIf="errorMessage" class="error">{{ errorMessage }}</p>
  </form>

  <!-- Forgot Password Form -->
  <form *ngIf="isForgotPassword">
    <div>
      <label>Email</label>
      <input placeholder="Enter your login email" type="email" [formControl]="forgotPasswordEmail" />
      <div *ngIf="forgotPasswordEmail.invalid && forgotPasswordEmail.touched" class="error">
        <p *ngIf="forgotPasswordEmail.errors?.['required']">Email is required.</p>
        <p *ngIf="forgotPasswordEmail.errors?.['email']">Please enter a valid email.</p>
      </div>
    </div>
    <button type="button" (click)="onForgotPassword()" [disabled]="forgotPasswordEmail.invalid">Send Reset Code</button>
    <p *ngIf="errorMessage" class="error">{{ errorMessage }}</p>
  </form>

  <!-- Reset Password Form -->
  <form (ngSubmit)="onResetPassword()" [formGroup]="resetPasswordForm" *ngIf="isResettingPassword">
    <input type="hidden" formControlName="email" />
    <div>
      <label>Reset Code</label>
      <input type="text" formControlName="resetCode" />
    </div>
    <div>
      <label>New Password</label>
      <input type="password" formControlName="newPassword" />
    </div>
    <button type="submit" [disabled]="resetPasswordForm.invalid">Reset Password</button>
    <p *ngIf="errorMessage" class="error">{{ errorMessage }}</p>
  </form>

  <p *ngIf="!isForgotPassword && !isResettingPassword">
    {{ isRegister ? 'Already have an account?' : 'Don\'t have an account?' }}
    <a (click)="toggleForm()">{{ isRegister ? 'Login' : 'Register' }}</a>
  </p>
  <p *ngIf="!isForgotPassword && !isResettingPassword"><a (click)="showForgotPassword()">Forgot Password?</a></p>
  <p *ngIf="isForgotPassword || isResettingPassword"><a (click)="showLogin()">Back to Login</a></p>
</div>